(()=>{"use strict";chrome.runtime.onInstalled.addListener((function(){chrome.contextMenus.create({id:"saveSnippet",title:"Save snippet",contexts:["selection"]})})),chrome.contextMenus.onClicked.addListener((function(e,t){e.selectionText&&t&&"saveSnippet"===e.menuItemId&&function(e,t){chrome.storage.local.get({snippets:{}},(function(n){var i,s=n.snippets;t.url&&(s[t.url]||(s[t.url]={urlTitle:null!==(i=t.title)&&void 0!==i?i:t.url,snippets:[]}),s[t.url].snippets.push({text:e,timestamp:(new Date).toLocaleString()}),chrome.storage.local.set({snippets:s},(function(){console.log("Snippet saved:",t,t.url,t.title)})),console.log("sending highlighttext:",t,t.id,e),t.id&&chrome.tabs.sendMessage(t.id,{action:"highlightText",text:e}))}))}(e.selectionText,t)}))})();